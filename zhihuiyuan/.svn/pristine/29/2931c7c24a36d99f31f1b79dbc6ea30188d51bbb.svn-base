<?php
namespace Home\Controller;

use Think\Controller;

use Think\Page;


class ReteacherController extends HomeController {
	public function index(){


		if($_SESSION['user']){
    		$this->assign('user',$_SESSION['user']);
    	}
		//显示讲师信息
		//$teacher = M('teacher')->order('createtime desc')->select();


		//讲师显示分页效果
			//$db = M('teacher');//实例化模型，参数为数据库表名称，不包含前缀
			$db = M('users');
		    if(isset($_GET['p'])){//判断地址栏是否有参数p；
		   		$page = $_GET['p'];
		    }else{
		   		$page = 1;
		    }
		    //import('ORG.Util.Page');//导入分页类;
		    $count = $db->count();//获取查询总记录数
		    $p = new Page($count,6);//实例化分页类
		    $show = $p->show();//分页显示输出
		    $this->assign('show',$show);//模板变量赋值


		    $result = $db->query('SELECT * FROM si_teacher n, si_users i WHERE n.id = i.tid ');

		    $result = $db->order('createtime desc')->page($page,6)->select();//按创建时间降序排序，每页查询10条;




		    $this->assign('result',$result);


		$this->assign('teacher',$teacher);
		$this->display();
	}

	public function details(){

		$teachOne = M('teacher')->where('id = '.$_GET['id'])->find();

		$teachOne1 = M('users')->where('tid = '.$teachOne['id'])->find();

		$this->assign('teachOne',$teachOne);
		$this->assign('teachOne1',$teachOne1);
		$this->display();
	}
}