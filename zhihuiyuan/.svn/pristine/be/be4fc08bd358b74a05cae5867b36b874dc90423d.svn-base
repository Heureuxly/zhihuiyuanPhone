<?php

    /*
     * Copyright(c)2015 All rights reserved.
     * @Licenced  http://wwww.w3.org
     * @Author Liyongmei <2516160097@qq.com>
     * @Create on 2015-11-26 20:39:15
     */

    /**
     * Description of LoginController
     *
     * @author Administrator
     */

    namespace Admin\Controller;

    use Think\Controller;

    class LoginController extends Controller {

        public function index() {
            $this->display("User/login");
        }

        //登录验证 接受AJAX发送来的数据请求 校验验证码
        public function login() {
            $userRec = M("admin_users")->where(array("uname" => I("post.uname")))->find();
            $verify = new \Think\Verify();
            if (empty($userRec)) {
                $this->ajaxReturn(array("status" => false, "message" => "账号不存在"));
            } elseif ($userRec['password'] != md5(I("post.password"))) {
                $this->ajaxReturn(array("status" => false, "message" => "密码不正确"));
            } else {
                $_SESSION['adminuser'] = $userRec;
                $this->ajaxReturn(array("status" => true, "message" => "登录成功，点击跳转！"));
            }
        }
        
        function V() {
        //设置配置参数
        $config = array(
            "fontSize" => 15,       //验证码字体大小
            "imageH" => 34,
            "imageW" => 100,
            "length" => 4,          //验证码位数
            "useNode" => true,      //开启验证码杂点
        );
        //实例化验证码类
        $Verify = new \Think\Verify($config);
        //生成验证码
        $Verify->entry();
    }
    
    public function checkVerify() {
        echo "<pre>";
        var_dump(session());
        exit;
    }

    
}
      